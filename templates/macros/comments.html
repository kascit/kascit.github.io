{% macro comments(config, page, section) %} {# Only show comments on blog posts
(pages under /blog/), not on sections, taxonomies, or other pages #} {% set
show_comments = false %} {# Check if this is a page (not a section) and it's
under /blog/ #} {% if page is defined and page.path is defined %} {% set
is_blog_post = page.path is starting_with('/blog/') and not page.path is
ending_with('/_index/') %} {# Allow explicit override via page frontmatter #} {%
if page.extra.comments is defined %} {% set show_comments =
page.extra.comments.enabled | default(value=false) %} {% else %} {# Default:
show comments only on blog posts #} {% set show_comments = is_blog_post %} {%
endif %} {% endif %} {# Check global config is enabled #} {% set global_enabled
= config.extra.comments and config.extra.comments.enabled %} {% if
global_enabled and show_comments %}
<div id="comments" class="mt-12">
  {% if config.extra.comments.system == "giscus" %}
  <script src="{{ get_url(path="js/comments-giscus.js") | safe }}"
          data-target="comments"
          data-repo="{{ config.extra.comments.repo | safe }}"
          data-repo-id="{{ config.extra.comments.repo_id | safe }}"
          data-category="{{ config.extra.comments.category | safe }}"
          data-category-id="{{ config.extra.comments.category_id | safe }}"
          data-mapping="{{ config.extra.comments.mapping | default(value='pathname') }}"
          data-strict="{{ config.extra.comments.strict | default(value='0') }}"
          data-reactions-enabled="{{ config.extra.comments.reactions_enabled | default(value='1') }}"
          data-emit-metadata="{{ config.extra.comments.emit_metadata | default(value='1') }}"
          data-input-position="{{ config.extra.comments.input_position | default(value='top') }}"
          data-lang="{{ config.extra.comments.lang | default(value='en') }}"
          data-loading="{{ config.extra.comments.loading | default(value='lazy') }}"></script>
  {% elif config.extra.comments.system == "utterances" %}
  <script
    src="https://utteranc.es/client.js"
    repo="{{ config.extra.comments.repo }}"
    issue-term="{{ config.extra.comments.issue_term | default(value='pathname') }}"
    theme="{{ config.extra.comments.theme | default(value='github-light') }}"
    crossorigin="anonymous"
    async
  ></script>
  {% endif %}
</div>
{% endif %} {% endmacro comments %}
