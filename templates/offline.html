{% import "macros/head.html" as macros_head %}
{% import "macros/header.html" as macros_header %}
{% import "macros/footer.html" as macros_footer %}
{% import "macros/sidebar.html" as macros_sidebar %}

{% set offline_title = "Offline" %}
{% set offline_desc = "No internet connection" %}
{% set offline_url = config.base_url ~ "/offline/" %}

<!DOCTYPE html>
{{ macros_head::html_tag(config=config, lang=config.default_language) }}
<head>
    {{ macros_head::head(
        config=config,
        page=page,
        section=false,
        current_url=offline_url
    ) }}
    <title>{{ offline_title }}</title>
    <meta name="description" content="{{ offline_desc }}">
    <meta property="og:title" content="{{ offline_title }}">
    <meta property="og:description" content="{{ offline_desc }}">
    <meta property="og:url" content="{{ offline_url }}">
</head>
<body>
    <div class="drawer lg:drawer-open">
        <input id="my-drawer-2" type="checkbox" class="drawer-toggle" autocomplete="off" />
        <div class="drawer-content flex flex-col pt-16">
            {{ macros_header::header(config=config, lang=config.default_language) }}
            <div class="p-8 w-full max-w-3xl mx-auto flex flex-col justify-center items-center min-h-[60vh]">
                <main class="flex flex-auto flex-col items-center justify-center px-4 text-center sm:flex-row">
                    <h1 class="text-2xl font-extrabold tracking-tight text-gray-900 sm:mr-6 sm:border-r sm:border-gray-900/10 sm:pr-6 sm:text-3xl dark:text-gray-200 sm:dark:border-gray-300/10">{{ offline_title }}</h1>
                    <h2 class="mt-2 text-gray-700 sm:mt-0 dark:text-gray-400">{{ offline_desc }}</h2>
                </main>
                <p id="offline-status" class="mt-4 text-sm text-gray-500 dark:text-gray-500"></p>
            </div>
        </div>
        <div id="sidebar" class="drawer-side fixed top-0 pt-12 bottom-0 z-40 border-r border-gray-500/15">
            {{ macros_sidebar::sidebar(config=config, lang=config.default_language, current_path='/', section=false) }}
        </div>
    </div>

    <!-- Theme toggle script - critical for functionality -->
    <script defer src="{{ get_url(path='goyo.js') | safe }}"></script>

    <!-- Auto-reload when back online -->
    <script>
        (function () {
            var el = document.getElementById('offline-status');
            el.textContent = 'Waiting for connection\u2026';

            function goBack() {
                el.textContent = 'Back online \u2014 reloading\u2026';
                el.style.color = '#4ade80';
                setTimeout(function () { window.location.reload(); }, 600);
            }

            if (navigator.onLine) { goBack(); return; }
            window.addEventListener('online', goBack);
        })();
    </script>
</body>
</html>
